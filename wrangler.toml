name = "worknote-maker-cf"
main = "src/index.ts"
account_id = "6ed03d41ee9287a3e0e5bde9a6772812"
compatibility_date = "2024-11-13"
compatibility_flags = ["nodejs_compat"]
placement = { mode = "smart" }

[[kv_namespaces]]
binding = "WORKNOTE_SYNC_STATE"
id = "49ef47530b4d42aaa54be79c584a18e6"
preview_id = "25a372d46cde40ae94ee1c64b00a0fb2"

[[kv_namespaces]]
binding = "WORKNOTE_FILE_VECTOR_INDEX"
id = "8a9adb1a58f24e089c2c8ff8a67c87a5"
preview_id = "b8133f510a91413eadc5354569d6cace"

[[vectorize]]
binding = "VECTORIZE"
index_name = "worknote-store"

# Cron trigger - Daily at 17:00 UTC (01:00 KST)
[triggers]
crons = ["0 17 * * *"]

[vars]
CHUNK_SIZE = "2000"
MAX_BATCH_SIZE = "32"
MAX_CONCURRENCY = "4"
MAX_RETRIES = "3"
INDEX_NAME = "worknote-store"

routes = [
  { pattern = "work.kadragon.work/*", zone_name = "kadragon.work" }
]

workers_dev = false
preview_urls = false

# Secrets to configure via wrangler secrets:
# GOOGLE_SERVICE_ACCOUNT_JSON, GOOGLE_ROOT_FOLDER_ID, OPENAI_API_KEY,
# CF_ACCESS_TEAM_DOMAIN, CF_ACCESS_AUD_TAG, GOOGLE_IMPERSONATION_EMAIL (optional),
# CF_ACCOUNT_ID (optional - for AI Gateway), CF_AI_GATEWAY_NAME (optional - for AI Gateway),
# CF_AI_GATEWAY_TOKEN (optional - for AI Gateway authentication),
# WEBHOOK_URL/WEBHOOK_TYPE, PERFORMANCE_THRESHOLD

[observability]
enabled = true
head_sampling_rate = 1
